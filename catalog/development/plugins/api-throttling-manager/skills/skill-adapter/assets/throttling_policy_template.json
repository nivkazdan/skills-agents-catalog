{
  "_comment": "Template for defining API throttling policies.  This file provides a structure and examples for configuring rate limits and quotas based on various criteria.",
  "policy_name": "default_policy",
  "_comment": "A descriptive name for the policy.",
  "description": "Default throttling policy applied to all API requests.",
  "_comment": "A brief description of the policy's purpose.",
  "default": true,
  "_comment": "Indicates if this is the default policy applied when no other policy matches.",
  "rules": [
    {
      "_comment": "Rule for authenticated users.",
      "name": "authenticated_user_rule",
      "criteria": {
        "_comment": "Criteria to match for this rule.  Multiple criteria are ANDed together.",
        "user_role": "authenticated",
        "_comment": "Example: Match users with the 'authenticated' role.  Could be 'admin', 'premium', etc.",
        "api_endpoint": ".*",
        "_comment": "Regular expression to match the API endpoint.  '.*' matches all endpoints.",
        "http_method": ".*",
        "_comment": "Regular expression to match the HTTP method. '.*' matches all methods."
      },
      "limits": {
        "_comment": "Rate limits and quotas to apply when the criteria are met.",
        "rate_limit": {
          "requests": 100,
          "_comment": "Maximum number of requests allowed.",
          "window": "1m",
          "_comment": "Time window for the rate limit (e.g., '1s', '1m', '1h', '1d')."
        },
        "quota": {
          "requests": 1000,
          "_comment": "Total number of requests allowed within the quota period.",
          "period": "1h",
          "_comment": "Quota period (e.g., '1h', '1d', '1w', '1M')."
        },
        "burst_size": 20,
        "_comment": "Maximum number of requests allowed in a burst above the rate limit."
      },
      "action": {
        "_comment": "Action to take when the limits are exceeded.",
        "type": "reject",
        "_comment": "Options: 'reject', 'delay'.",
        "delay_ms": 0,
        "_comment": "Delay in milliseconds if 'delay' action is selected. Ignored for 'reject'."
      }
    },
    {
      "_comment": "Rule for anonymous users.",
      "name": "anonymous_user_rule",
      "criteria": {
        "user_role": "anonymous",
        "api_endpoint": ".*",
        "http_method": ".*"
      },
      "limits": {
        "rate_limit": {
          "requests": 10,
          "window": "1m"
        },
        "quota": {
          "requests": 100,
          "period": "1h"
        },
        "burst_size": 5
      },
      "action": {
        "type": "reject",
        "delay_ms": 0
      }
    },
    {
      "_comment": "Rule for a specific API endpoint.",
      "name": "sensitive_endpoint_rule",
      "criteria": {
        "api_endpoint": "^/sensitive-data/.*$",
        "_comment": "Regular expression matching the '/sensitive-data/' endpoint and its sub-resources.",
        "http_method": "GET"
      },
      "limits": {
        "rate_limit": {
          "requests": 5,
          "window": "1m"
        },
        "quota": {
          "requests": 50,
          "period": "1h"
        },
        "burst_size": 2
      },
      "action": {
        "type": "reject",
        "delay_ms": 0
      }
    }
  ]
}